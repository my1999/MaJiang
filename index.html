<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>麻将记账助手</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="麻将记账">
    <script>
        // 注册Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker 注册成功:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker 注册失败:', error);
                    });
            });
        }
    </script>
</head>
<body>
    <div class="app-container">
        <!-- 主页 -->
        <div id="home-page" class="page active">
            <header class="page-header">
                <h1>麻将记账助手</h1>
            </header>
            <div class="main-buttons">
                <button id="new-game-btn" class="btn btn-primary">开始新游戏</button>
                <button id="history-btn" class="btn">查看历史记录</button>
                <button id="stats-btn" class="btn">长期输赢统计</button>
            </div>
        </div>

        <!-- 玩家管理页面 -->
        <div id="player-page" class="page">
            <header class="page-header">
                <h1>玩家管理</h1>
                <button id="back-to-home" class="btn-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
            </header>
            <div class="player-selection">
                <h2>选择4位玩家开始游戏</h2>
                <div id="player-list" class="player-grid">
                    <!-- 玩家列表将动态生成 -->
                </div>
                <div class="selected-info">已选择 <span id="selected-count">0</span>/4 名玩家</div>
                <button id="add-player-btn" class="btn">
                    <span class="icon">+</span> 添加新玩家
                </button>
                <button id="start-game-btn" class="btn btn-primary" disabled>开始游戏</button>
            </div>
        </div>

        <!-- 添加玩家弹窗 -->
        <div id="add-player-modal" class="modal">
            <div class="modal-content">
                <h2>添加新玩家</h2>
                <div class="form-group">
                    <label for="player-name">玩家姓名</label>
                    <input type="text" id="player-name" placeholder="请输入姓名" maxlength="8">
                </div>
                <div class="form-group">
                    <label>选择头像</label>
                    <div class="avatar-grid">
                        <div class="avatar-option" data-id="1">😊</div>
                        <div class="avatar-option" data-id="2">😎</div>
                        <div class="avatar-option" data-id="3">🤓</div>
                        <div class="avatar-option" data-id="4">😄</div>
                        <div class="avatar-option" data-id="5">🤠</div>
                        <div class="avatar-option" data-id="6">🐱</div>
                        <div class="avatar-option" data-id="7">🐶</div>
                        <div class="avatar-option" data-id="8">🐼</div>
                        <div class="avatar-option" data-id="9">🐻</div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="cancel-add-player" class="btn">取消</button>
                    <button id="save-player" class="btn btn-primary" disabled>保存</button>
                </div>
            </div>
        </div>

        <!-- 游戏记录页面 -->
        <div id="game-page" class="page">
            <header class="page-header">
                <h1>游戏记录</h1>
                <div class="game-info">局数: <span id="round-count">0</span></div>
            </header>

            <!-- 玩家头像和名称栏 -->
            <div class="players-bar" id="players-bar">
                <!-- 玩家信息将在这里动态生成 -->
            </div>

            <!-- 当前回合记录区 -->
            <div class="current-round">
                <div class="round-header">
                    <span>第 <span id="current-round-number">1</span> 局</span>
                </div>
                <div class="score-inputs" id="score-inputs">
                    <!-- 得分输入将在这里动态生成 -->
                </div>
                <div class="round-actions">
                    <button id="check-scores-btn" class="btn">看看谁赢了</button>
                    <button id="confirm-round-btn" class="btn btn-primary">确认本局</button>
                </div>
            </div>

            <!-- 历史记录区 -->
            <div class="history-section">
                <h3>历史记录</h3>
                <div id="rounds-history" class="rounds-history">
                    <!-- 历史记录将在这里动态生成 -->
                </div>
            </div>

            <!-- 结束游戏按钮 -->
            <div class="game-actions">
                <button id="end-game-btn" class="btn btn-accent">不玩了，结账</button>
            </div>
        </div>

        <!-- 当前得分弹窗 -->
        <div id="current-scores-modal" class="modal">
            <div class="modal-content">
                <h2>当前得分</h2>
                <div id="current-scores-list" class="scores-list">
                    <!-- 当前得分将在这里动态生成 -->
                </div>
                <div class="modal-actions">
                    <button id="close-scores-modal" class="btn btn-primary">关闭</button>
                </div>
            </div>
        </div>

        <!-- 结算页面 -->
        <div id="settlement-page" class="page">
            <header class="page-header">
                <h1>游戏结算</h1>
            </header>
            <div class="settlement-info">
                <div>总局数: <span id="total-rounds">0</span></div>
                <div>日期: <span id="game-date"></span></div>
            </div>
            <div id="final-scores" class="final-scores">
                <!-- 最终得分将在这里动态生成 -->
            </div>
            <div class="settlement-actions">
                <button id="return-home-btn" class="btn btn-primary">返回主页</button>
            </div>
        </div>

        <!-- 历史记录页面 -->
        <div id="history-page" class="page">
            <header class="page-header">
                <h1>历史记录</h1>
                <button id="back-from-history" class="btn-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
            </header>
            <div id="history-list" class="history-list">
                <!-- 历史游戏记录将在这里动态生成 -->
            </div>
            <div id="no-history" class="empty-state" style="display: none;">
                <p>暂无历史记录</p>
            </div>
        </div>

        <!-- 长期统计页面 -->
        <div id="stats-page" class="page">
            <header class="page-header">
                <h1>长期输赢统计</h1>
                <button id="back-from-stats" class="btn-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
            </header>
            <div id="stats-list" class="stats-list">
                <!-- 玩家统计将在这里动态生成 -->
            </div>
            <div id="no-stats" class="empty-state" style="display: none;">
                <p>暂无统计数据</p>
            </div>
        </div>

        <!-- 删除确认弹窗 -->
        <div id="delete-confirm-modal" class="modal">
            <div class="modal-content">
                <h2>确认删除</h2>
                <p>确定要删除玩家 "<span id="delete-player-name"></span>" 吗？</p>
                <p class="warning">注意：删除后无法恢复，且与该玩家相关的所有游戏记录仍将保留。</p>
                <div class="modal-actions">
                    <button id="cancel-delete" class="btn">取消</button>
                    <button id="confirm-delete" class="btn btn-danger">删除</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html> 